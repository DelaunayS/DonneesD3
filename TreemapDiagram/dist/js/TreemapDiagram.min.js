const MovieSalesUrl="https://cdn.freecodecamp.org/testable-projects-fcc/data/tree_map/movie-data.json";let MovieSalesData,hierarchieData,color=d3.schemeAccent;const margin={top:50,right:30,bottom:10,left:70},width=1e3,height=600,REGEX_GROUPS=/(\d)(?=(\d\d\d)+(?!\d))/g;function useGrouping(t,a=" "){return t.toString().replace(REGEX_GROUPS,`$1${a}`)}let svgContainer=d3.select("#graphContainer");const drawSvgContainer=()=>{svgContainer.attr("width",1e3).attr("height",600)},drawRect=()=>{hierarchieData=d3.hierarchy(MovieSalesData,(t=>t.children)).sum((t=>t.value)).sort(((t,a)=>a.value-t.value)),d3.treemap().size([1e3,600]).paddingInner(1)(hierarchieData);let t=svgContainer.selectAll("g").data(hierarchieData.leaves()).enter();t.append("rect").attr("transform",(t=>"translate("+t.x0+","+t.y0+")")).attr("class","tile").attr("data-name",(t=>t.data.name)).attr("data-category",(t=>t.data.category)).attr("data-value",(t=>t.data.value)).attr("fill",(t=>"Action"===t.data.category?color[0]:"Drama"===t.data.category?color[1]:"Adventure"===t.data.category?color[2]:"Family"===t.data.category?color[3]:"Animation"===t.data.category?color[4]:"Comedy"===t.data.category?color[5]:"Biography"===t.data.category?color[6]:void 0)).attr("height",(t=>t.y1-t.y0)).attr("width",(t=>t.x1-t.x0)).on("mouseover",((t,a)=>{tooltip.transition().style("opacity",.9).style("top",t.pageY-margin.top-margin.bottom+"px").style("left",t.pageX+10+"px"),tooltip.html(a.data.name+"<br/>"+useGrouping(a.data.value)+" $"),document.querySelector("#tooltip").setAttribute("data-value",a.data.value)})).on("mouseout",(t=>{tooltip.transition().style("opacity",0)})),t.append("foreignObject").text((t=>t.data.name)).attr("class","textCell").attr("x",(t=>t.x0)).attr("y",(t=>t.y0)).attr("width",(t=>t.x1-t.x0)).attr("height",(t=>t.y1-t.y0)).on("mouseover",((t,a)=>{tooltip.transition().style("opacity",.9).style("top",t.pageY-margin.top-margin.bottom+"px").style("left",t.pageX+10+"px"),tooltip.html(a.data.name+"<br/>"+useGrouping(a.data.value)+" $"),document.querySelector("#tooltip").setAttribute("data-value",a.data.value)})).on("mouseout",(t=>{tooltip.transition().style("opacity",0)}))},createLegend=()=>{let t=d3.select("#legend");t.attr("width",500).attr("height",85);const a=a=>{t.append("rect").attr("class","legend-item").attr("width",20).attr("height",20).attr("fill",color[a]).attr("transform","translate("+(5+120*a)+",15)"),t.append("text").attr("x",27+120*a).attr("y",30).text((()=>{switch(a){case 0:return"Action";break;case 1:return"Drame";break;case 2:return"Aventure";break;case 3:return"Familial";break;default:break}}))},e=a=>{t.append("rect").attr("class","legend-item").attr("width",20).attr("height",20).attr("fill",color[a]).attr("transform","translate("+(120*a-355)+",55)"),t.append("text").attr("x",120*a-333).attr("y",70).text((()=>{switch(a){case 4:return"Animation";break;case 5:return"Comédie";break;case 6:return"Biographie";break;default:break}}))};for(let t=0;t<4;t++)a(t);for(let t=4;t<7;t++)e(t)};d3.json(MovieSalesUrl).then((function(t,a){if(a)throw void 0;MovieSalesData=t,svgContainer.attr("width",1e3).attr("height",600),drawRect(),createLegend()}));const tooltip=d3.select("body").append("div").attr("id","tooltip").style("opacity",0);